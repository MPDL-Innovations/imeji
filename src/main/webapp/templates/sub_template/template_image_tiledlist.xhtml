<ui:composition template="../template_site.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:imjc="http://java.sun.com/jsf/composite/components"
                xmlns:menu="http://java.sun.com/jsf/composite/components/menu"
                xmlns:item="http://java.sun.com/jsf/composite/components/item">
	
  
    <ui:define name="modalDialogs_from_template">
        <!-- Confirmation Pages -->
        <ui:include src="../../confirmationPages/AllDelete.xhtml">
            <ui:param name="bean" value="#{paginatorListSessionBean}"/>
        </ui:include>
        <ui:include src="../../confirmationPages/AllWithdraw.xhtml">
            <ui:param name="bean" value="#{paginatorListSessionBean}"/>
        </ui:include>
        <ui:include src="../../confirmationPages/SelectedDelete.xhtml">
            <ui:param name="bean" value="#{paginatorListSessionBean}"/>
        </ui:include>
        <ui:include src="../../confirmationPages/SelectedWithdraw.xhtml">
            <ui:param name="bean" value="#{paginatorListSessionBean}"/>
        </ui:include>
    </ui:define>

	<ui:define name="actionsMenu">
		<menu:actionItems id="actionItems" itemsBean="#{paginatorListSessionBean}" rendered="#{currentMainMenu == 'items' and empty SessionBean.selected}"/>
		<menu:actionCollection id="actionCollection" collectionBean="#{paginatorListSessionBean}" rendered="#{currentMainMenu == 'collection' and empty SessionBean.selected and Auth.update(paginatorListSessionBean)}"/>
		<menu:actionSelectedItems id="actionSelectedItems" itemsBean="#{paginatorListSessionBean}" rendered="#{not empty SessionBean.selected}" />
	</ui:define>
	
    <!-- Main Content - Image tiled list - START -->
    <ui:define name="mainContent">
		
        <h:panelGroup layout="block" id="ajaxWrapper">
			<script>menuRightOffset();</script>
            <!-- Selection Info Panel -->
            <imjc:selectionInfoPanel id="selPanel" 
                                      fSession="#{FacetFiltersSession}" 
                                      facetBean="#{paginatorListSessionBean}" 
                                      currentMainMenu="mediaEntry" 
                                      browseToAllUrl="#{browseToAllItemsUrl}" 
                                      numberOfElements="#{paginatorListSessionBean.totalNumberOfElements}"
                                      containerId="#{containerId}" showSortMenu="true" objectLabel="#{lbl.images}"
                                      rendered="#{paginatorListSessionBean.totalNumberOfElements != 0}"/>
                  
	
			<div id="itemsArea" class="itemsArea #{paginatorListSessionBean.totalNumberOfElements != 0 || not empty paginatorListSessionBean.query ? '' : 'imj_dragOver'}" ondragover="this.style.opacity = .5 " ondragleave="this.style.opacity = 1">
				
				<item:thumbnailList  id="browseContent" picList="#{paginatorListSessionBean}" rendered="#{SessionBean.selectedBrowseListView == 'THUMBNAIL'}"/>
           		<item:detailList id="browseContentDL" listBean="#{paginatorListSessionBean}" rendered="#{SessionBean.selectedBrowseListView == 'LIST'}"/>
           		
           		<div id="uploadTitle" class="uploadDragAndDropTitle">
	           		<ui:fragment rendered="#{paginatorListSessionBean.totalNumberOfElements == 0 and not empty paginatorListSessionBean.query}">
	           			<span class="fa fa-exclamation-triangle"/> #{msg.no_images_found}!
	           		</ui:fragment>
	           		<ui:fragment rendered="#{paginatorListSessionBean.totalNumberOfElements == 0 and empty paginatorListSessionBean.query}">
	           			<span class="fa fa-upload"/> #{lbl.uploadFile}	
	           		</ui:fragment>
           		</div>
           		
			</div>
			<!-- Page Browser GotoBox -->
            <imjc:rangePageBrowserGotobox paginatorBean="#{paginatorListSessionBean}" addJSFunctions="yes" showSwitchListView="true" rendered="#{paginatorListSessionBean.totalNumberOfElements != 0}"/>

            <h:form id="updatePageForm">
	           <h:commandButton id="updateItems" value="update" action="#{paginatorListSessionBean.update}" style="display:none">
	           		<f:ajax execute="@this" render=":ajaxWrapper"/>
	           </h:commandButton>
           </h:form>
           <imjc:upload browseButtonId="upload" collectionId="#{paginatorListSessionBean.collectionId}" updateButtonId="updatePageForm:updateItems" dropElementId="itemsArea"/>
        </h:panelGroup>
    </ui:define>
    <!-- Main Content - END -->
    <script>
        $('form input[type=text]').die('keydown').keydown(function (e) {
            if (e.keyCode == 13) {
                $('form\\:submitButton').click();
                return false;
            }
        });
    </script>

</ui:composition>