<ui:composition template="templates/sub_template/template_entrypage.xhtml" 
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:imjc="http://java.sun.com/jsf/composite/components"
	xmlns:dialog="http://java.sun.com/jsf/composite/components/dialogs"
	xmlns:menu="http://java.sun.com/jsf/composite/components/menu">
	
	<ui:param name="headline" value="#{ViewCollectionBean.collection.metadata.title}"/>
	<ui:param name="currentMainMenu" value="collection"/>
	<ui:param name="logicBean" value="#{ViewCollectionBean}"/>
	<ui:param name="listSize" value="#{ViewCollectionBean.size}"/>
	
	<ui:define name="init">
		<h:outputText value="#{ViewCollectionBean.init()}"/>
	</ui:define>
	
	<ui:define name="actionsMenu">
		<menu:context_subNavigation contextId="#{logicBean.id}" contextUrl="#{Navigation.collectionUrl}" curMainMenu="#{currentMainMenu}" userHasAdminRights="#{AuthorizationBean.admin}" userHasEditRights="#{logicBean.editable and logicBean.collection.status != 'WITHDRAWN'}" hasContent="#{logicBean.size > 0}" navBean="#{Navigation}" activeMenu="start"/>
		
		<menu:context_actionMenu isUserLoggedIn="#{SessionBean.user != null}" curMainMenu="#{currentMainMenu}" navBean="#{Navigation}" collectionStatus="#{logicBean.collection.status}" contextId="#{logicBean.id}" isDeletable="#{logicBean.deletable}" isEditable="#{logicBean.editable}" hasContent="#{logicBean.size > 0}" contextDownloadParam="&amp;col=#{logicBean.id}"/>
	</ui:define>
	
	<ui:define name="additonalHeaderScripts">
		<script type="text/javascript" src="#{Navigation.applicationUrl}resources/js/qrcode.js"></script>
		<script type="text/javascript">
			jQuery(document).ready(function() {
				var qrHtml = document.getElementById('qr');
				if (qrHtml != null){
					qrHtml.innerHTML = create_qrcode('#{ViewCollectionBean.pageUrl}');
				}
			});
			var draw_qrcode = function(text, typeNumber, errorCorrectLevel) {
				document.write(create_qrcode(text, typeNumber, errorCorrectLevel) );
			};
			var create_qrcode = function(text, typeNumber, errorCorrectLevel, table) {
				var qr = qrcode(typeNumber || 10, errorCorrectLevel || 'M');
				qr.addData(text);
				qr.make();
				// return qr.createTableTag();
				return qr.createImgTag();
			};
		</script>
		
	</ui:define>
	<!-- COLLECTION Menu END -->
	
	<!-- ModalDialogs - Confirmation Pages -->
	<ui:define name="modalDialogs_from_site">
		<dialog:confirmationDialog submitAction="release" bean="#{logicBean}" confirmationText="#{msg.confirmation_release_collection}?" submitLabel="#{lbl.release}" dialogId="releaseMenuItemDialog" rendered="#{logicBean.editable and logicBean.collection.status.toString().toUpperCase() == 'PENDING' and logicBean.size > 0}"/>
		<dialog:confirmationDialog submitAction="delete" bean="#{logicBean}" confirmationText="#{msg.confirmation_delete_collection}?" submitLabel="#{lbl.delete}" dialogId="deleteMenuItemDialog" rendered="#{logicBean.deletable}"/>
		<dialog:confirmationReasonedDialog submitAction="withdraw" bean="#{logicBean}" confirmationText="#{msg.confirmation_withdraw_collection}" submitLabel="#{lbl.withdraw}" dialogId="withdrawMenuItemDialog" rendered="#{logicBean.editable and logicBean.collection.status.toString().toUpperCase() == 'RELEASED'}"/>
	</ui:define>
	
</ui:composition>
