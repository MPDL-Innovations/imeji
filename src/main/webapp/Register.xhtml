<ui:composition template="templates/template_site.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:imjc="http://java.sun.com/jsf/composite/components"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:html5="http://xmlns.jcp.org/jsf/passthrough">

	<ui:param name="headline" value="#{lbl.register}" />
	<ui:param name="title" value="#{headline}" />
	<ui:param name="hideRegister" value="true" />
	
	<f:metadata>
		<f:viewParam name="token" value="#{PasswordChangeBean.token}" />
	</f:metadata>

	<ui:define name="mainContent">
		<h:panelGroup style="width:96%" layout="block" id="registerArea"
			rendered="#{RegistrationBean.registrationEnabled}">

			<ui:fragment rendered="#{PasswordChangeBean.token==null}">
				<h2 class="imj_headline">#{lbl.registration}</h2>

				<ul class="imj_registerSteps">
					<li class="imj_active">1. #{lbl.register}</li>
					<li>2. #{lbl.register_activate}</li>
				</ul>

				<div class="imj_registerText">
						<h:outputText value="#{Configuration.registrationSnippet}"
							escape="false" />
					</div>

				<div class="loginArea">
					<h:form id="userForm">
						<div class="imj_metadataSet">
							<div class="imj_metadataLabel">
								<h:outputText value="#{lbl.email} *" />
								<span class="imj_noDisplay">: </span>
							</div>
							<div class="imj_metadataValue">
								<div class="imj_metadataValueEntry">
									<h:inputText type="text" name="email" html5:type="email"
										value="#{RegistrationBean.user.email}"
										styleClass="imj_admindataEdit" />
								</div>
							</div>
						</div>
						<imjc:person id="userPersonRegister"
							person="#{RegistrationBean.user.person}"
							bean="#{RegistrationBean}" position="0" userSource="" />


						<div class="imj_metadataSet">
							<div class="imj_metadataLabel">
								<ui:fragment
									rendered="#{Configuration.termsOfUse != '' or Configuration.termsOfUseUrl != ''}">
									<h:selectBooleanCheckbox id="accept_terms"
										value="#{RegistrationBean.termsAccepted}" />
					 		    	#{lbl.agree_to}
						 		     <h:outputLink title="#{lbl.terms_of_use}" target="_blank"
										value="#{Configuration.termsOfUseUrl}"
										rendered="#{Configuration.termsOfUseUrl != ''}">
										<h:outputText value="#{lbl.terms_of_use}" />
									</h:outputLink>
									<h:outputLink title="#{lbl.terms_of_use}" target="_blank"
										value="#{Navigation.termsOfUseUrl}"
										rendered="#{Configuration.termsOfUseUrl == ''}">
										<h:outputText value="#{lbl.terms_of_use}" />
									</h:outputLink>
									#{lbl.required_marker}
								</ui:fragment>
								<span class="imj_noDisplay">: </span>
							</div>
							<div class="imj_metadataValue">
								<h:commandButton action="#{RegistrationBean.register}"
									type="submit" value="#{lbl.register_now}"
									styleClass="imj_submitButton" />
								#{lbl.required_marker} #{lbl.required}
							</div>
						</div>


					</h:form>
				</div>

			</ui:fragment>
			<ui:fragment rendered="#{!(PasswordChangeBean.token==null)}">
				<h2 class="imj_headline">#{lbl.activate}</h2>

				<ul class="imj_registerSteps">
					<li>1. #{lbl.register}</li>
					<li class="imj_active">2. #{lbl.register_activate}</li>
				</ul>
				<imjc:password submitFunction="#{PasswordChangeBean.activate()}" submitText="#{lbl.activate}"/>
				
			</ui:fragment>

		</h:panelGroup>
	</ui:define>

</ui:composition>