<ui:composition template="templates/template_site.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:imjc="http://java.sun.com/jsf/composite/components"
	xmlns:f="http://xmlns.jcp.org/jsf/core">

	<ui:param name="headline" value="#{lbl.register}" />
	<ui:param name="title" value="#{headline}" />
	<ui:param name="hideRegister" value="true" />

	<ui:define name="mainContent">
		<h:panelGroup style="width:96%" layout="block" id="registerArea"
			rendered="#{RegistrationBean.registrationEnabled}">

			<ui:fragment rendered="#{!RegistrationBean.activation_submitted}">
				<h2 class="imj_headline">#{lbl.registration}</h2>

				<ui:fragment
					rendered="#{!RegistrationBean.activation_submitted and !RegistrationBean.registration_success}">
					<ul class="imj_registerSteps">
						<li class="imj_active">1. #{lbl.register}</li>
						<li>2. #{lbl.register_activate}</li>
					</ul>

					<h:outputText value="#{Configuration.registrationSnippet}"
						escape="false" />

					<ui:fragment id="formArea">
						<h:form id="userForm"
							rendered="#{!RegistrationBean.registration_success}">
							<div class="imj_metadataSet">
								<div class="imj_metadataLabel">
									<h:outputText value="#{lbl.email} *"/>
									<span class="imj_noDisplay">: </span>
								</div>
								<div class="imj_metadataValue">
									<div class="imj_metadataValueEntry">
										<h:inputText type="text" name="email"
											value="#{RegistrationBean.user.email}"
											styleClass="imj_admindataEdit" />
									</div>
								</div>
							</div>
							<imjc:person id="userPersonRegister"
								person="#{RegistrationBean.user.person}"
								bean="#{RegistrationBean}" position="0" userSource=""/>

							<ui:fragment
								rendered="#{Configuration.termsOfUse != '' or Configuration.termsOfUseUrl != ''}">
								<h:selectBooleanCheckbox id="accept_terms"
									value="#{RegistrationBean.termsAccepted}" />
				 		    	#{lbl.agree_to}
					 		     <h:outputLink title="#{lbl.terms_of_use}" target="_blank"
									value="#{Configuration.termsOfUseUrl}"
									rendered="#{Configuration.termsOfUseUrl != ''}">
									<h:outputText value="#{lbl.terms_of_use}" />
								</h:outputLink>
								<h:outputLink title="#{lbl.terms_of_use}" target="_blank"
									value="#{Navigation.termsOfUseUrl}"
									rendered="#{Configuration.termsOfUseUrl == ''}">
									<h:outputText value="#{lbl.terms_of_use}" />
								</h:outputLink>

							</ui:fragment>

							<div class="imj_submitPanel">
								<h:commandButton action="#{RegistrationBean.register}"
									type="submit" value="#{lbl.register_now}"
									styleClass="imj_submitButton" />
								#{lbl.required_marker} #{lbl.required}
							</div>

						</h:form>
					</ui:fragment>

				</ui:fragment>

				<!-- Registration was successfull -->
				<ui:fragment
					rendered="#{RegistrationBean.registration_submitted and RegistrationBean.registration_success}">
					<ul class="imj_registerSteps">
						<li class="imj_active imj_submitted">1. #{lbl.register}</li>
						<li>2. #{lbl.register_activate}</li>
					</ul>
					<p>#{msg.registration_thank_you}</p>
					<p>#{msg.registration_check_email}</p>
				</ui:fragment>
			</ui:fragment>

			<!-- Activation (positive/negative) -->
			<ui:fragment rendered="#{RegistrationBean.activation_submitted}">
				<h2 class="imj_headline">#{lbl.register_activation}</h2>
				<ul class="imj_registerSteps">
					<li>1. #{lbl.register}</li>
					<ui:fragment rendered="#{RegistrationBean.activation_success}">
						<li class="imj_active imj_submitted">2.
							#{lbl.register_activate}</li>
					</ui:fragment>
					<ui:fragment rendered="#{!RegistrationBean.activation_success}">
						<li class="imj_active">2. #{lbl.register_activate}</li>
					</ui:fragment>
				</ul>

				<p>
					<h:outputText styleClass="imj_messageStatus"
						value="#{RegistrationBean.activation_message}"
						rendered="#{RegistrationBean.activation_success}" />
					<h:outputText styleClass="imj_messageError"
						value="#{RegistrationBean.activation_message}"
						rendered="#{!RegistrationBean.activation_success}" />
				</p>
				<!-- LogIn -->
				<ui:fragment rendered="#{RegistrationBean.activation_success}">
					<ui:include src="./include/LoginFormular.xhtml" />
				</ui:fragment>

			</ui:fragment>

		</h:panelGroup>
	</ui:define>

</ui:composition>