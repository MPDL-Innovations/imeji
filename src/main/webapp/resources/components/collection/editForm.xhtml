<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:imjc="http://java.sun.com/jsf/composite/components"
	xmlns:html5="http://xmlns.jcp.org/jsf/passthrough">

<composite:interface>
	<composite:attribute name="formularBean" required="true" />
	<composite:attribute name="formularContextBean" required="true" />
</composite:interface>

<composite:implementation>
	<style>
		 .moxie-shim-html5{
		 	position: relative !important;
		 	height: auto !important;
		 }
	</style>
	<h:form id="form" onkeydown="if (event.keyCode == 13) { document.getElementById('editContainer:form:save').click(); return false; }">
		<div class="imj_descriptionArea">
			<div class="imj_metadataSet">
				<label class="imj_metadataLabel">#{lbl.title} *</label>
				<h:inputText id="inputTitleText" styleClass="imj_metadataValue" value="#{cc.attrs.formularContextBean.title}" html5:autofocus="true" />
			</div>
			<div class="imj_metadataSet">
				<label class="imj_metadataLabel">#{lbl.description}</label>
				<h:inputTextarea id="inputDescription" styleClass="imj_metadataValue" value="#{cc.attrs.formularContextBean.description}" />
			</div>
			<h:panelGroup id="authors">
				<ui:repeat id="persons" var="creator" value="#{cc.attrs.formularContextBean.persons}" varStatus="indexA">
					<div class="imj_authorMetadataSet">
						<div class="imj_sectionHeadline">
							<h4>
								<span class="imj_inlineButtonGroup"> 
									<h:commandLink styleClass="fa fa-plus-square-o" title="#{lbl.add_author}" action="#{cc.attrs.formularBean.addAuthor(indexA.index)}">
										<f:ajax execute=":editContainer:form:authors" render=":editContainer:form:authors" />
									</h:commandLink>
									<h:commandLink styleClass="fa fa-minus-square-o" title="#{lbl.remove_author}" action="#{cc.attrs.formularBean.removeAuthor(indexA.index)}">
										<f:ajax execute=":editContainer:form:authors" render=":editContainer:form:authors" />
									</h:commandLink>
								</span>
								#{lbl.authors}
							</h4>
						</div>
						<imjc:person id="collectionAuthor" containerId=":editContainer:form:authors" person="#{creator}" bean="#{cc.attrs.formularBean}" position="#{indexA.index}" />
					</div>
				</ui:repeat>
			</h:panelGroup>
			<h:panelGroup id="additionalInfos">
				<div class="imj_sectionHeadline">
					<h4>#{lbl.colUtil}</h4>
				</div>
				<ui:repeat id="list" var="info" value="#{cc.attrs.formularContextBean.additionalInformations}" varStatus="indexA">
					<div class="imj_sectionHeadline">
						<!-- Add/Remove Author buttons -->
						<span class="imj_inlineButtonGroup"> 
							<h:commandLink styleClass="fa fa-plus-square-o" title="#{lbl.add_author}" action="#{cc.attrs.formularBean.addAdditionalInfo(indexA.index)}">
								<f:ajax execute="editContainer:form:additionalInfos" render="editContainer:form:additionalInfos" />
							</h:commandLink>
							<h:commandLink styleClass="fa fa-minus-square-o" title="#{lbl.remove_author}" action="#{cc.attrs.formularBean.removeAdditionalInfo(indexA.index)}">
								<f:ajax execute="editContainer:form:additionalInfos" render="editContainer:form:additionalInfos" />
							</h:commandLink>
						</span>
					</div>
					<div class="imj_metadataSet">
						<label class="imj_metadataLabel">#{lbl.label} *</label>
						<h:inputText id="inputInfoLabel" styleClass="imj_metadataValue" autocomplete="off" value="#{info.label}" html5:placeholder="#{lbl.placeholder_additional_info_label}" />
					</div>
					<div class="imj_metadataSet">
						<label class="imj_metadataLabel">#{lbl.text}</label>
						<h:inputTextarea id="inputInfoText" styleClass="imj_metadataValue" value="#{info.text}" html5:placeholder="#{lbl.placeholder_text}" />
					</div>
					<div class="imj_metadataSet">
						<label class="imj_metadataLabel">#{lbl.url}</label>
						<h:inputText id="inputInfoUrl" styleClass="imj_metadataValue" value="#{info.url}" html5:placeholder="#{lbl.placeholder_url}" />
					</div>
				</ui:repeat>
				<div class="imj_sectionHeadline">
					<span class="imj_inlineButtonGroup">
						<h:commandLink styleClass="fa fa-plus-square-o" title="#{lbl.add} #{lbl.colUtil}" action="#{cc.attrs.formularBean.addAdditionalInfo(cc.attrs.formularContextBean.additionalInformations.size())}">
							<f:ajax execute="editContainer:form:additionalInfos" render="editContainer:form:additionalInfos" />
						</h:commandLink>
					</span>
				</div>
			</h:panelGroup>
			<div class="imj_metadataSet">
				<label class="imj_metadataLabel">#{lbl.logo}</label>
				<div class="imj_metadataValue">
					<ui:fragment rendered="#{cc.attrs.formularBean.collection.logoUrl!=null}">
						#{lbl.removeLogo}
						<h:commandLink styleClass="fa fa-times" title="#{lbl.removeLogo}" action="#{cc.attrs.formularBean.removeContainerLogo}">
							<f:ajax execute="@form" render="@form :additonalFooterScripts" />
						</h:commandLink><br/>
						<img alt="Logo" src="#{cc.attrs.formularBean.collection.logoUrl}" height="50em" class="imj_community_logo" /> 
					</ui:fragment>
					<div id="uploader" class=" imj_singleUpload">
						<div id="filelist">Your browser doesn't have Flash, Silverlight or HTML5 support.</div>
						<div class="imj_messageError" id="console"></div>
						<div id="container">
							<a id="pickfiles" href="#"><span class="fa fa-upload"/> #{lbl.uploadLogo}</a>
						</div>
					</div>
				</div>
			</div>
			<div class="imj_metadataSet">
				<label class="imj_metadataLabel"></label>
				<div class="imj_metadataValue">
					<a href="#{HistorySession.previousPage.completeUrlWithHistory}" class="imj_cancelButton">#{lbl.cancel}</a>
					<h:commandButton id="save" action="#{cc.attrs.formularBean.save}" value="#{lbl.save}" type="submit" styleClass="imj_submitButton" onclick="startLoader();window.location.hash = '#';">
						<f:ajax render=":imj_pageMessageArea" execute="@form"/>
					</h:commandButton>
					* #{lbl.required}
				</div>
			</div>
		</div>
	</h:form>
</composite:implementation>
</html>