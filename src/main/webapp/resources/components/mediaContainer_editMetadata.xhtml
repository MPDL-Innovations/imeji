<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:imjc="http://java.sun.com/jsf/composite/components"
	xmlns:mdprofile="http://java.sun.com/jsf/composite/components/mdProfile">

<composite:interface>
	<composite:attribute name="formularBean" required="true" />
	<composite:attribute name="formularContextBean" required="true" />
	<composite:attribute name="headline" required="true" />
</composite:interface>

<composite:implementation>

	<h:panelGroup layout="block" class="imj_mediaContainerEditMD">
		<h:form id="mediaContainerForm">
			<div class="imj_headline">
				<h3>
					<h:outputText value="#{cc.attrs.headline}" />
				</h3>
			</div>
			<div class="imj_descriptionArea">
				<!-- Title -->
				<div class="imj_metadataSet">
					<label class="imj_metadataLabel"> <h:outputText
							value="#{lbl.title} *" /> <span class="imj_noDisplay">: </span>
					</label>
					<h:inputText id="inputTitleText" styleClass="imj_metadataValue"
						value="#{cc.attrs.formularContextBean.metadata.title}" />
				</div>

				<!-- Description -->
				<div class="imj_metadataSet">
					<label class="imj_metadataLabel"> <h:outputText
							value="#{lbl.description}" /> <span class="imj_noDisplay">:
					</span>
					</label>
					<h:inputTextarea id="inputDescription"
						styleClass="imj_metadataValue"
						value="#{cc.attrs.formularContextBean.metadata.description}" />
				</div>
				
				<h:outputText value="* #{lbl.mandatory}" />
				
				<!-- Author data -->
				<ui:repeat id="persons" var="creator" value="#{cc.attrs.formularContextBean.metadata.persons}" varStatus="indexA">
					<h:panelGroup layout="block" styleClass="imj_authorMetadataSet">
						<div class="imj_sectionHeadline">
							<h4>
								<!-- Add/Remove Author buttons -->
								<span class="imj_inlineButtonGroup"> 
									<h:commandButton styleClass="imj_buttonAdd_16" title="#{lbl.add_author}" action="#{cc.attrs.formularBean.addAuthor(indexA.index)}">
										<f:ajax execute="@this" render="@form" />
									</h:commandButton>
									<h:commandButton styleClass="imj_buttonRemove_16" title="#{lbl.remove_author}" action="#{cc.attrs.formularBean.removeAuthor(indexA.index)}">
										<f:ajax execute="@this" render="@form" />
									</h:commandButton>
								</span>
								<h:outputText value=" #{lbl.author}" />
								<span class="imj_noDisplay">: </span>
							</h4>
						</div>
						
						<!-- The user of the person -->
						<imjc:person id="collectionAuthor" person="#{creator}" bean="#{cc.attrs.formularBean}" position="#{indexA.index}" />

					</h:panelGroup>
				</ui:repeat>
				
				<div class="imj_submitPanel">
					<h:outputLink value="#{HistorySession.previousPage.completeUrlWithHistory}" styleClass="imj_cancelButton">
						<h:outputText value="#{lbl.cancel}"/>
					</h:outputLink>
					<h:commandButton action="#{cc.attrs.formularBean.save}" value="#{lbl.save}" styleClass="imj_submitButton" onclick="openDialog('dialogWait');"/>
				</div>
				
				
		<!-- START NEW FEATURE -->
				<h:panelGroup layout="block" id="previewArea"  rendered="#{cc.attrs.formularBean.modeCreate}">
					<input type="checkbox" id="useTemplate" checked="checked" onchange="$('#templateSelect, .imj_metadataProfilePreview').toggle(); $($('.imj_submitPanel').get(0)).toggle();"/>
					<label for="useTemplate">#{lbl.profile_use_template}</label>
					
					<ui:fragment>
						<div class="imj_customSelectbox" id="templateSelect">
							<div class="imj_showSelection">
								<div class="imj_selectionText">use predefined values</div>
								<div class="imj_buttonSortDescending_16"></div>
							</div>
							
							<h:selectOneMenu id="profileTemplates" value="#{cc.attrs.formularBean.selectedProfileItem}">
								<f:selectItems value="#{cc.attrs.formularBean.profileItems}"/>
								<f:ajax event="change" execute="@this" render="metadataprofilepreview" listener="#{cc.attrs.formularBean.profileChangeListener}"/>
							</h:selectOneMenu> 
							
						</div>
						

				<h:panelGroup id="metadataprofilepreview">		
					<imjc:metadataProfile_view headline="#{lbl.collection_profile}" metadataBean="#{cc.attrs.formularBean}" metadataContextBean="#{cc.attrs.formularBean.collection}" 
							metadataProfile="#{cc.attrs.formularBean.profileTemplate}"/>
					
					
					<ui:remove>
					<ui:repeat var="statement" value="#{cc.attrs.formularBean.profile.statements}">
						<div class="imj_metadataProfileItem">
							<div class="imj_sectionHeadline">
								<h4>
									<h:outputText value="#{lbl.metadata}"/>
									<span class="imj_noDisplay">: </span>
								</h4>
							</div>
							
							<div class="imj_metadataSet">
								<label class="imj_metadataLabel">							
									<h:outputText value="#{lbl.metadata_id}"/>
									<span class="imj_noDisplay">: </span>
								</label>
								<span class="imj_metadataValue">
									<h:outputText value="#{statement.id}"/>
								</span>
							</div>
							
							<div class="imj_metadataSet">
								<label class="imj_metadataLabel">
									<h:outputText value="#{lbl.type}"/>
									<span class="imj_noDisplay">: </span>
								</label>
								<span class="imj_metadataValue">
									<h:outputText value="#{statement.type}"/>
								</span>
							</div>
							
							<div class="imj_metadataSet">
								<label class="imj_metadataLabel">
									<h:outputText value="#{lbl.labels}"/>
									<span class="imj_noDisplay">: </span>
								</label>
								<span class="imj_metadataValue">
									<ui:repeat var="label" value="#{statement.labels}" varStatus="indexO">
										<h:outputText value=", " rendered="#{indexO.index > 0}"/>
										<h:outputText value="#{label.value}"/>
										<h:outputText value=" (#{label.lang})"/>
									</ui:repeat>
								</span>
							</div>
							
							<ui:fragment rendered="#{!(empty statement.literalConstraints)}">
								<div class="imj_metadataSet">
									<label class="imj_metadataLabel">
										<h:outputText value="#{lbl.values}"/>
										<span class="imj_noDisplay">: </span>
									</label>
									<span class="imj_metadataValue">
										<ui:repeat var="value" value="#{statement.literalConstraints}" varStatus="indexO">
											<h:outputText value=", " rendered="#{indexO.index > 0}"/>
											<h:outputText value="#{value}"/>
										</ui:repeat>
									</span>
								</div>
							</ui:fragment>
							
							<ui:fragment rendered="#{statement.vocabulary != null}">
								<div class="imj_metadataSet">
									<label class="imj_metadataLabel">
										<h:outputText value="#{lbl.vocabulary}"/>
										<span class="imj_noDisplay">: </span>
									</label>
									<span class="imj_metadataValue">
										<h:outputText value="#{statement.vocabulary}"/>
									</span>
								</div>
							</ui:fragment>
						</div>
					</ui:repeat>
					
					</ui:remove>
				</h:panelGroup>					

				<ui:remove>  <mdprofile:profile_preview profileBean=""/> </ui:remove>
					</ui:fragment>
				</h:panelGroup>
		<!-- START END FEATURE -->
		
			</div>
		
		
			
			<div class="imj_submitPanel"  rendered="#{cc.attrs.formularBean.modeCreate}">
				<h:outputLink value="#{HistorySession.previousPage.completeUrlWithHistory}" styleClass="imj_cancelButton">
					<h:outputText value="#{lbl.cancel}"/>
				</h:outputLink>
				<h:commandButton action="#{cc.attrs.formularBean.save}" value="#{lbl.save}" styleClass="imj_submitButton" onclick="openDialog('dialogWait');"/>
			</div>
		</h:form>
	</h:panelGroup>
</composite:implementation>
</html>