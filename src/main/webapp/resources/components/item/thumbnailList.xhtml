<div xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:imj="http://java.sun.com/jsf/composite/components">
	<composite:interface>
		<composite:attribute name="picList"/>
	</composite:interface>
	<composite:implementation>
		<style>.imj_tileItem {width: #{Configuration.thumbnailWidth}px !important;}</style>
		<h:panelGroup layout="block" styleClass="imj_tiledMediaList" rendered="#{cc.attrs.picList.totalNumberOfElements != 0}">
			<div class="imj_listBody" id="listDiv" style=" text-align: justify;  text-align-last: justify;">
				<ul id="imj_listBody"> 
					<!-- Images -->	
					
					<ui:repeat id="pictureList" var="item" value="#{cc.attrs.picList.currentPartList}" offset="0" varStatus="index">
						
						<li class="imj_tileItem">
							<ui:param name="uri" value="#{item.uri}"/>
							
							<h:form id="itemSelectForm">
							
								<div id="imgFrame" class="#{item.selected ? 'imj_selected'  : ''} imj_tileThumbnailArea" >
									<!-- Image with link to the details view -->
									<a href="#{cc.attrs.picList.imageBaseUrl}item/#{item.id}?q=#{cc.attrs.picList.query}&amp;fq=#{cc.attrs.picList.facetQueryString}&amp;pos=#{cc.attrs.picList.offset + index.index}">
										<img src="#{item.link}" alt="#{item.caption}"/>
									</a>
									<span class="imj_optionSet">
										<h:selectBooleanCheckbox rendered="#{item.status != 'WITHDRAWN'}" styleClass="imj_optionCheckbox" id="pictureCheckbox" value="#{item.selected}" valueChangeListener="#{item.selectedChanged}">
											<f:ajax event="change" execute="@this" render=":ajaxWrapper :actionsMenuArea"/>
										</h:selectBooleanCheckbox>
										<h:outputLabel for="pictureCheckbox" value="#{item.caption}" title="#{item.caption}" styleClass="imj_optionLabel"/>
									</span>
								</div>
								
								<!-- Browse / Search Result / All Pictures of one Person Pages / resource -->
								
							</h:form>
							
							<div class="imj_tooltip">
								<imj:thumbnailPopup item="#{item}"/>
							</div>
						</li>
						
					</ui:repeat>
					<!-- End images -->
					<ui:repeat id="emptyPictureList" var="nothing" value="#{cc.attrs.picList.emptyList}">
						<li class="imj_tileItem">
						</li>
					</ui:repeat>
					
					<!-- 
						Show/hide metadata popup Needs to be defined in ajax area to rebind the DOM objects
					-->
				</ul>
			</div>
		</h:panelGroup>
		<div id="log"></div>
		
		<script>
		/*var count= 0;
		var position = 0;
		$(".imj_tileItem").each(function() {
			var newTop = $( this ).position().top;		
			if(position > 0 &amp;&amp; newTop > position){
				count =$(".imj_tileItem").index( this );
				return false;
			}
			position = newTop;
		});
		var date=new Date();
		date.setTime(+date+(365*24*3600*1000));
		if(count > 0){
			document.cookie="ELEMENTS_PER_LINE_COOKIE="+count+"; expires="+date.toGMTString()+"; path=/";
		}
		else{
			var firstLeft=$(".imj_tileItem:nth-child(1)").position().left;
			var secondLeft=$(".imj_tileItem:nth-child(2)").position().left;
			var width=$(".imj_listBody").first().width();
			var count2=Math.round(width/(secondLeft-firstLeft));
			//This count is either exactly the number of thumbnaisl per line or, due to borders, one more
			if(count2-1!=getElementsPerLineCookie()){	
				document.cookie="ELEMENTS_PER_LINE_COOKIE="+count2+"; expires="+date.toGMTString()+"; path=/";
			}
		}
		
		function getElementsPerLineCookie(){
			return document.cookie.replace(/(?:(?:^|.*;\s*)ELEMENTS_PER_LINE_COOKIE\s*\=\s*([^;]*).*$)|^.*$/, "$1");
		}*/
		
		</script>
	</composite:implementation>
</div>